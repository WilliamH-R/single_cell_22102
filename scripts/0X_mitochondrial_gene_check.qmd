---
title: "Detection of mitochondrial genes in Seurat object"
format: html
editor: visual
---

# Imports

```{r}
library(Seurat)
library(tidyverse)
```

# Load RAW data

```{r}
raw_data <- readRDS("/home/projects/22102_single_cell_2025/projects/group_1/d72106bd-d03b-45e6-a0fa-ca2a831ef092.rds")
```

How are the gene names encodded

```{r}
head(rownames(raw_data))
```

As ENSEMBL IDs as required

Saving the gene names in a new object

```{r}
gene_names <- rownames(raw_data)
```

# Creating list of mitochondrial genes from https://www.genenames.org/data/genegroup/#!/group/1974

```{r}
mito_genes <- read_tsv(file = "https://www.genenames.org/cgi-bin/genegroup/download?id=1974&type=node")

## Selectin relevant variables for inspection
mito_genes <- mito_genes |> 
  dplyr::select(`Approved symbol`, `Ensembl gene ID`)

View(mito_genes)
```

Now checking if the ENSEMBL IDs from the mitochondrial gene list is contained in the gene list from the seurat object

```{r}
sum(gene_names %in% mito_genes$`Ensembl gene ID`)
```

Sum is 0 - i.e. no mitochondrial genes in the raw seurat object.



# Creating list of ribosomal genes from https://www.genenames.org/cgi-bin/genegroup/download?id=1054&type=branch
```{r}
ribosomal_gene_list <- read_tsv(file = "https://www.genenames.org/cgi-bin/genegroup/download?id=1054&type=branch")

ribosomal_gene_list <- ribosomal_gene_list |> 
  dplyr::select(`Approved symbol`, `Ensembl gene ID`)

RP_L_S_genes <- ribosomal_gene_list |> 
  dplyr::filter(str_detect(string = `Approved symbol`, pattern = "^RP[SL]"))
```

Checking for ribosomal genes
```{r}
sum(RP_L_S_genes %in% rownames(raw_data))
```
Nothing there either


Checking if some really frequent gene is in the rownames(raw_data) - for example TGFB1 and CD8A
Creating vector with ENSEMBLID for CD8A and TGFB1
```{r}
cd8_tgfb1_ensemblid <- c("ENSG00000153563", "ENSG00000105329")
```

Checking if these genes are contained in the rownames - the code should give result 2.
```{r}
sum(cd8_tgfb1_ensemblid %in% rownames(raw_data))
```
So obviously no difficulties in convsersion of ENSEMBLIDs.


### Checking for hemoglobin genes as a tool for subsetting data
We use the pattern "^HB[^(P)]" which pertain to the pattern HB but excluding HB followed by P (i.e. the heatshock binding proteins)
```{r}
library(AnnotationDbi)

annots <- select(org.Hs.eg.db, 
                 keys=rownames(raw_data), 
                columns="SYMBOL", 
                keytype="ENSEMBL")


hb_genes <- annots |> 
  filter(str_starts(SYMBOL, "HB"))

head(hb_genes, 13)
```
Manually looking up genes we find that HBEGF, HBS1L and HBP1 are not hemoglobin related genes, so when we calculate the percentage of hemoglobin genes, we should exclude these by the regex ^HB(?![ESP]). 


