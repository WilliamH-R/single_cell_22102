# Imports
```{r}
suppressPackageStartupMessages({
 library(Seurat)
 library(scDblFinder)
})
```

# Load data
```{r}
filtered_data <- readRDS("../data/filtered_data.rds")
```

# Find doublets
```{r}
#Convert your seurat object to a sce object
sce <- as.SingleCellExperiment(filtered_data)

set.seed(10010101)
sce.dbl <- scDblFinder(sce,
                       samples = "donor_id",
                       clusters = colLabels(sce))

plotUMAP(sce.dbl, colour_by="scDblFinder.score")

table(sce.dbl$scDblFinder.class)

plotColData(sce.dbl,
            x="RNA_snn_res.0.3",
            y="scDblFinder.score",
            colour_by=("scDblFinder.class"))
```

