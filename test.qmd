
```{r}
test_data <- readRDS("/home/projects/22102_single_cell_2025/projects/group_1/d72106bd-d03b-45e6-a0fa-ca2a831ef092.rds")
```


```{r}
RenameGenesSeurat <- function(obj,
                              newnames) { # Replace gene names in different slots of a Seurat object. Run this before integration. Run this before integration. It only changes obj@assays$RNA@counts, @data and @scale.data.
  print("Run this before integration. It only changes obj@assays$RNA@counts, @data and @scale.data.")
  RNA <- obj@assays$RNA

  if (nrow(RNA) == length(newnames)) {
    if (length(RNA@counts)) RNA@counts@Dimnames[[1]]            <- newnames
    if (length(RNA@data)) RNA@data@Dimnames[[1]]                <- newnames
    if (length(RNA@scale.data)) RNA@scale.data@Dimnames[[1]]    <- newnames
  } else {"Unequal gene sets: nrow(RNA) != nrow(newnames)"}
  obj@assays$RNA <- RNA
  return(obj)
}
test_data_2 <- test_data

test_data_2 <- RenameGenesSeurat(obj = test_data_2,
                                 newnames = unfactor(test_data_2@assays[["RNA"]]@meta.features[["feature_name"]]))
```

```{r}
library(Seurat)

test_data_2[["is_ensg"]] <- grepl("^ENSG", rownames(test_data_2))
test_data_2 <- subset(test_data_2, subset = is_ensg == FALSE)


test_data_2[["percent.mt.2"]] <- Seurat::PercentageFeatureSet(test_data_2, pattern = "^MT")

head(test_data_2@meta.data$percent.mt)
head(test_data_2@meta.data$percent.mt.2)

VlnPlot(test_data_2, features = c("percent.mt", "percent.mt.2"), alpha = 0.02)
```

